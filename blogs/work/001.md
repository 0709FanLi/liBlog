---
title: 工作遇到的问题总结
date: 2022-07-25
tags:
  - 问题
categories:
  - 工作
---

# 前言

对工作中遇到的问题进行总结

## H5 页面在低版本手机打不开的问题

### 背景

使用 vue-cli 新建了一个 h5 的项目(只有三个页面)，内嵌在移动端。从开发到测试一直都没遇到什么太大的问题，
直到兼容性测试的时候，测试同学说低版本安卓打不开 8 版本以下下打不开，所有低版本型号的手机都打不开，但是公司
其它项目倒没什么问题。

并没有在网上查到相关的资料，最后对比了公司另一个相似的项目，发现有一个配置是不同的，vue-cli 默认的配置是这样的

```
"browserslist": [
    "> 1%",
    "last 2 versions",
    "not dead"
]
```

当把 **browserslist** 改成如下这样就可以正常打开了

```
"browserslist": [
    "> 1%",
    "last 2 versions",
    "not ie <= 8",
    "chrome >= 14",
    "safari >= 3",
    "ios >= 8",
    "android >= 4.0",
    "not dead"
]
```

#### 那么 browserslist 作用是什么呢

根据浏览器的环境来智能添加 css 前缀，js 的 polyfill 垫片,来兼容旧版本浏览器。避免不必要的兼容代码，以提高代码的编译质量。

共享使用 browserslist 的组件：

| 组件名           | 功能                                    |
| ---------------- | --------------------------------------- |
| Autoprefixer     | postcss 添加 css 前缀组件               |
| bable-preset-env | 编译预设环境 智能添加 polyfill 垫片代码 |
| 等等             |                                         |

只要 package.json 配置了 browserslist 对象,需要的组件将**自动匹配**到并使用,也可以配置到**具体的组件参数**上，当然也可以以单独的文件形式存在。

| 例子                       | 说明                                                    |
| -------------------------- | ------------------------------------------------------- |
| > 1%                       | 全球超过 1%人使用的浏览器                               |
| > 5% in US                 | 指定国家使用率覆盖                                      |
| last 2 versions            | 所有浏览器兼容到最后两个版本根据 CanIUse.com 追踪的版本 |
| Firefox ESR                | 火狐最新版本                                            |
| Firefox > 20               | 指定浏览器的版本范围                                    |
| not ie <=8                 | 方向排除部分版本                                        |
| Firefox 12.1               | 指定浏览器的兼容到指定版本                              |
| unreleased versions        | 所有浏览器的 beta 测试版本                              |
| unreleased Chrome versions | 指定浏览器的测试版本                                    |
| since 2013                 | 2013 年之后发布的所有版本                               |

到这里已经能明白为什么在低版本安卓打不开了。

## 禁止滚轮默认事件问题

背景：功能，使用滚轮控制轮播图的播放

1. 禁止滚轮的默认事件(防止页面滚动)
2. 滚轮前后滑动控制轮播图的前后播放

禁止在前还是控制播放的逻辑在前？禁止在前，其实这个时候是没有办法获取滚轮滚动的距离等信息，如果播放在前，页面又会滚动，最好的办法是，获取到滚动的距离信息之后，禁止默认事件，逻辑大致是这样的，

1. 获取默认事件的信息
2. 禁止滚轮的默认事件(防止页面滚动)
3. 滚轮前后滑动控制轮播图的前后播放

### 参考文章

    [browserslist详解](https://blog.csdn.net/yiguang_820/article/details/118112863)

未完待续~
